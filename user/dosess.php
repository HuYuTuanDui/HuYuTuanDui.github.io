<?php/***尊重著作权 请勿删改以下信息* @author    Yujianyue <admin@ewuyi.net>* @copyright Copyright (c) 2014-2112 12391.Net*/$ng = $_COOKIE['wi'];$db=ConnectMysqli::getIntance($conn);$sql="select * from `user` ORDER BY `id` DESC LIMIT 1";$pass=$db->getRow($sql);if(stristr("|NULL|null|","|{$pass}|")){//没有记录吧或读取记录失败webalert("用户名或密码错误0!","index.php");}$wi = $pass['wi'];if($ng==md5($wi)){}else{//用户名和数据库不符合webalert("用户名或密码错误1!","index.php");}$pl = $pass['password'];if(strlen($pl)<8){//应该是32位加密长度webalert("用户名或密码错误2!","index.php");}$de = strtolower($ng);If($_COOKIE['password'] == md5($pl.$qi)){$su = 'yes';$nf='<a href="dodate.php" class="rt">发布</a>';$nf.='<a href="dofile.php" class="rt">管理</a>';$nf.='<a href="index.php" class="rt">退出</a>';}else{$nf='<a href="index.php" class="rt">登录</a>';setcookie("wi","",time()-60*60*24*1);setcookie("password","",time()-60*60*24*1);webalert("请重新登录3!","index.php");}?>